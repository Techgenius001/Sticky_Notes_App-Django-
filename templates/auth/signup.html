{% extends "base.html" %}
{% block title %}Sign up ¬∑ Midnight Notes{% endblock %}
{% block content %}
<div class="min-h-[calc(100vh-56px)] flex items-center justify-center px-4">
    <div class="w-full max-w-md rounded-2xl border border-neutral-800 bg-[#1E1E1E]/90 shadow-xl shadow-black/60 p-6 auth-card">
        <h1 class="text-lg font-semibold mb-1">Create your space</h1>
        <p class="text-xs text-neutral-400 mb-6">A quiet board for focused thinking.</p>
        <form method="post" class="space-y-4 text-sm" id="signup-form">
            {% csrf_token %}
            {% for field in form %}
                <div class="space-y-1">
                    <label class="block text-xs text-neutral-300">{{ field.label }}</label>
                    {% if field.name == 'password1' or field.name == 'password2' %}
                        <div class="relative">
                            {{ field }}
                            <button type="button"
                                    class="password-toggle absolute inset-y-0 right-2 flex items-center text-[11px] text-neutral-400 hover:text-neutral-200"
                                    data-target-id="{{ field.id_for_label }}">
                                üëÅ
                            </button>
                        </div>
                    {% else %}
                        {{ field }}
                    {% endif %}
                    {# Show field-specific help text for non-password fields (e.g. username rules) #}
                    {% if field.name != 'password1' and field.name != 'password2' and field.help_text %}
                        <p class="text-[11px] text-neutral-500">{{ field.help_text|safe }}</p>
                    {% endif %}
                    {# For all fields (including passwords), show only actual validation errors after submit #}
                    {% if field.errors %}
                        <p class="text-[11px] text-red-400">{{ field.errors|striptags }}</p>
                    {% endif %}
                </div>
            {% endfor %}
            <button type="submit" class="w-full mt-3 inline-flex items-center justify-center rounded-lg bg-[#4F8CFF] px-4 py-2.5 text-xs font-medium text-white hover:bg-[#3b6fd1] transition-colors">
                Sign up
            </button>
        </form>
        <p class="mt-4 text-[11px] text-neutral-400">
            Already have an account?
            <a href="{% url 'login' %}" class="text-[#4F8CFF] hover:underline">Sign in</a>
        </p>
    </div>
</div>
{% endblock %}

{% block extra_body %}
{{ block.super }}
<script>
    document.querySelectorAll('.password-toggle').forEach(btn => {
        btn.addEventListener('click', () => {
            const input = document.getElementById(btn.dataset.targetId);
            if (!input) return;
            input.type = input.type === 'password' ? 'text' : 'password';
        });
    });
</script>
{% endblock %}
